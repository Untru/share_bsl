# Введение
Приветствую всех! Давно зрела идея поделиться своим опытом в формате статьи. Что бы понять о чем эта статья, я думаю надо вначали озвучить мои цели.

## Мои цели
**Личная мотивация**

Хотел выйти за пределы привычной 1С, попробовать что-то новое, но с минимальным порогом входа. Выбор пал на OneScript и фреймворк Осень. После доклада Никиты узнал, что многие концепции заимствованы из Java — это стало отличным поводом изучить новые подходы, оставаясь в знакомой среде (без необходимости знать английский).

**Помощь сообществу**

В процессе изучения столкнулся с тем, что материалов по Осени не так много. Решил, что мой опыт может помочь другим, кто так же хочет разобраться, но сталкивается с трудностями.
И именно по этому решил что статья будет в формате "Мастер класс", так, на примерах сильно проще мне, а возможно и вам во всем этом разбираться.

# Выбор проекта

Сложнее всего было определиться с идеей. Я работаю в франчайзи, и коллеги часто присылают обработки, расширения и т.д. Просматривать их с телефона неудобно, а оперативно проверять код — иногда необходимо. Это и породило идею создать механизм, с помощью которого я смогу быстро глянуть исходники и прокоментировать код.

**Решение:**

Создать Telegram-бота, в который кидаем бинарники а он их преобразует в читаемый код.

Проблемы с которым я столкнулся:

**Проблема №1:** Как удобно просматривать код?
**Вариант 1:** Отправлять сырой текст в Telegram.
**Минусы:** нечитаемо, ограничение на 3000 символов.

Вариант 2: Использовать Paste1C.
Проблема: для многомодульных обработок придется генерировать множество ссылок — неудобно.

Вариант 3: Файлообменники.
Минусы: неудобно для быстрого просмотра.

Вариант 4: Gist GitHub.

Почему Gist?

Позволяет сравнивать правки между версиями (как diff в 1С).

Есть доступ по ссылке (аналог Google Docs). Код виден только тем, кому вы дали ссылку.

Идея с приватными репозиториями показалась сложной, поэтому в своем решении оставил возможность гибкой настройки доступа.

Кратко о OneScript (для понимания контекста)
В OneScript есть классы. Проведу аналогию с 1С:

bsl
ОбработкаОбъект1 = Обработки.НашаОбработка.Создать();  
ОбработкаОбъект1.Имя = "Вася";  
ОбработкаОбъект2 = Обработки.НашаОбработка.Создать();  
ОбработкаОбъект2.Имя = "Петя";  
Здесь мы создаем два экземпляра (инстанса) обработки. В OneScript классы работают похожим образом: сначала описывается структура, затем создаются экземпляры.

Задача: Telegram-бот
Как говорится, «хороший программист — ленивый программист», поэтому начал с поиска готовых библиотек. Нашел OPI (ссылка) — это значительно упростило работу.

Шаг 1: Создание и запуск приложения
Приведу пример кода для отправки сообщения в Telegram:

bsl
...  
Шаг 2: Обработка входящих сообщений
Первый наивный подход — «лесенка» из условий:

bsl
Если ТипСообщения = "Сообщение" Тогда  
    // Логика...  
ИначеЕсли ТипСообщения = "Файл" Тогда  
    // Логика...  
Иначе  
    // ...  
КонецЕсли;  
Но такой код сложно поддерживать. Решение нашлось в документации Осени:...